# ğŸ“œ å¤æ–‡å­—è¯†åˆ«åŠ©æ‰‹ - Django ç‰ˆæœ¬

ä¸€ä¸ªåŸºäº Django æ¡†æ¶çš„å¤æ–‡å­—ï¼ˆç”²éª¨æ–‡ã€æ•¦ç…Œæ–‡ä¹¦ç­‰ï¼‰è¯†åˆ«å’Œé‡Šè¯»åŠ©æ‰‹ï¼Œé›†æˆäº†ç™¾åº¦æ–‡å¿ƒå¤§æ¨¡å‹çš„è§†è§‰è¯†åˆ«èƒ½åŠ›ã€‚

## åŠŸèƒ½ç‰¹æ€§

âœ¨ **æ ¸å¿ƒåŠŸèƒ½**
- ğŸ–¼ï¸ ä¸Šä¼ é«˜æ¸…å¤æ–‡å­—å›¾ç‰‡ï¼ˆPNG/JPGï¼‰
- ğŸ¤– åŸºäºæ–‡å¿ƒå¤§æ¨¡å‹çš„æ™ºèƒ½è¯†åˆ«ä¸é‡Šè¯»
- ğŸ“‹ æ”¯æŒå¤šç§å¤æ–‡å­—ä½“ç³»ï¼ˆç”²éª¨æ–‡ã€æ•¦ç…Œæ–‡ä¹¦ã€é‡‘æ–‡ã€ç¯†ä¹¦ã€éš¶ä¹¦ï¼‰
- ğŸ’¡ æä¾›ç”¨æˆ·æç¤ºæ”¯æŒï¼ˆæ—¶ä»£ã€æ–‡æœ¬ç‰‡æ®µã€å‡ºå¤„ç­‰ï¼‰
- ğŸ“Š å®Œæ•´çš„åˆ†ææŠ¥å‘Šï¼ˆMarkdown æ ¼å¼ï¼‰
- ğŸ’¾ åˆ†æå†å²è®°å½•å­˜å‚¨
- ğŸ¨ å®£çº¸æ°´å¢¨é£è®¾è®¡ç•Œé¢

## å®‰è£…ä¸é…ç½®

### 1. ç¯å¢ƒå‡†å¤‡

```bash
# å…‹éš†æˆ–è¿›å…¥é¡¹ç›®ç›®å½•
cd /Users/jafekin/Codes/Python\ Projects/font

# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼ˆæ¨èï¼‰
python3 -m venv venv
source venv/bin/activate  # macOS/Linux
# venv\Scripts\activate   # Windows

# å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

### 2. ç¯å¢ƒå˜é‡é…ç½®

å¤åˆ¶ç¤ºä¾‹æ–‡ä»¶å¹¶é…ç½®ï¼š

```bash
cp .env.example .env
```

ç¼–è¾‘ `.env` æ–‡ä»¶ï¼Œé…ç½®ä»¥ä¸‹å†…å®¹ï¼š

```env
DEBUG=True
SECRET_KEY=your-secret-key-change-this-in-production
OPENAI_API_KEY=5124588afef0ea3dba67365a5b9cd429283ba74d
OPENAI_BASE_URL=https://aistudio.baidu.com/llm/lmapi/v3
ALLOWED_HOSTS=localhost,127.0.0.1
```

> âš ï¸ **ç”Ÿäº§ç¯å¢ƒæ³¨æ„**ï¼š
> - æ›´æ”¹ `SECRET_KEY` ä¸ºä¸€ä¸ªå®‰å…¨çš„éšæœºå­—ç¬¦ä¸²
> - è®¾ç½® `DEBUG=False`
> - é…ç½®æ­£ç¡®çš„ `ALLOWED_HOSTS`

### 3. æ•°æ®åº“è¿ç§»

```bash
python manage.py migrate
```

### 4. åˆ›å»ºè¶…çº§ç”¨æˆ·ï¼ˆå¯é€‰ï¼‰

```bash
python manage.py createsuperuser
```

## å¿«é€Ÿå¼€å§‹

### 1. å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
# ä½¿ç”¨å‘½ä»¤è¡Œ
python manage.py runserver

# æˆ–ä½¿ç”¨ VS Code ä»»åŠ¡
# å¿«æ·é”®: Ctrl+Shift+B æˆ– Cmd+Shift+B (macOS)
```

### 2. è®¿é—®åº”ç”¨

ä¸»é¡µ: **http://localhost:8000**

åå°ç®¡ç†: **http://localhost:8000/admin**

**ç™»å½•å‡­è¯**:
- ç”¨æˆ·å: `admin`
- å¯†ç : `password123`

### 3. ä½¿ç”¨åº”ç”¨

1. åœ¨ä¸»é¡µä¸Šä¼ å¤æ–‡å­—å›¾ç‰‡ï¼ˆPNG/JPGï¼‰
2. é€‰æ‹©æ–‡å­—ç±»å‹å’Œæä¾›å¯é€‰æç¤º
3. ç‚¹å‡»"å¼€å§‹è¯†åˆ«å¤æ–‡å­—"
4. ç³»ç»Ÿå°†è°ƒç”¨ç™¾åº¦æ–‡å¿ƒå¤§æ¨¡å‹è¿›è¡Œè¯†åˆ«
5. æŸ¥çœ‹åˆ†æç»“æœå’Œå†å²è®°å½•

## é¡¹ç›®ç»“æ„

```
font/
â”œâ”€â”€ manage.py                 # Django ç®¡ç†è„šæœ¬
â”œâ”€â”€ requirements.txt          # Python ä¾èµ–
â”œâ”€â”€ .env.example             # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â”œâ”€â”€ README.md                # æœ¬æ–‡ä»¶
â”‚
â”œâ”€â”€ config/                  # Django é…ç½®
â”‚   â”œâ”€â”€ settings.py          # å…¨å±€è®¾ç½®
â”‚   â”œâ”€â”€ urls.py              # URL è·¯ç”±
â”‚   â”œâ”€â”€ wsgi.py              # WSGI åº”ç”¨
â”‚   â””â”€â”€ __init__.py
â”‚
â”œâ”€â”€ app/                     # ä¸»åº”ç”¨
â”‚   â”œâ”€â”€ templates/
â”‚   â”‚   â””â”€â”€ index.html       # å‰ç«¯ç•Œé¢
â”‚   â”œâ”€â”€ static/              # é™æ€æ–‡ä»¶ï¼ˆCSS/JSï¼‰
â”‚   â”œâ”€â”€ migrations/          # æ•°æ®åº“è¿ç§»
â”‚   â”œâ”€â”€ models.py            # æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ views.py             # ä¸šåŠ¡é€»è¾‘
â”‚   â”œâ”€â”€ urls.py              # åº”ç”¨è·¯ç”±
â”‚   â”œâ”€â”€ admin.py             # åå°ç®¡ç†é…ç½®
â”‚   â”œâ”€â”€ apps.py              # åº”ç”¨é…ç½®
â”‚   â””â”€â”€ __init__.py
â”‚
â””â”€â”€ media/                   # ç”¨æˆ·ä¸Šä¼ æ–‡ä»¶
    â””â”€â”€ uploads/
```

## API æ¥å£

### 1. ä¸»é¡µ
- **URL**: `/`
- **æ–¹æ³•**: GET
- **åŠŸèƒ½**: è¿”å›å‰ç«¯ç•Œé¢

### 2. åˆ†ææ¥å£
- **URL**: `/api/analyze`
- **æ–¹æ³•**: POST
- **å‚æ•°**:
  - `image`: å›¾ç‰‡æ–‡ä»¶ (å¿…éœ€)
  - `script_type`: æ–‡å­—ç±»å‹ (å¯é€‰ï¼Œé»˜è®¤ï¼šç”²éª¨æ–‡)
  - `hint`: ç”¨æˆ·æç¤º (å¯é€‰)

**è¯·æ±‚ç¤ºä¾‹**:
```python
import requests

with open('image.jpg', 'rb') as f:
    files = {'image': f}
    data = {
        'script_type': 'ç”²éª¨æ–‡',
        'hint': 'å•†ä»£åœè¾'
    }
    response = requests.post('http://localhost:8000/api/analyze', files=files, data=data)
    print(response.json())
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "result": "# åˆæ­¥åˆ¤è¯»\n- å¯èƒ½çš„æ–‡å­—ä½“ç³»ï¼šç”²éª¨æ–‡...",
  "analysis_id": 1
}
```

### 3. Base64 åˆ†ææ¥å£
- **URL**: `/api/analyze-base64`
- **æ–¹æ³•**: POST
- **å‚æ•°** (JSON):
  - `image`: Base64 å›¾ç‰‡æ•°æ® (å¿…éœ€)
  - `script_type`: æ–‡å­—ç±»å‹ (å¯é€‰)
  - `hint`: ç”¨æˆ·æç¤º (å¯é€‰)

### 4. å†å²è®°å½•æ¥å£
- **URL**: `/api/history`
- **æ–¹æ³•**: GET
- **å“åº”**: æœ€è¿‘ 20 æ¡åˆ†æè®°å½•

## æŠ€æœ¯æ ˆ

- **åç«¯æ¡†æ¶**: Django 4.2
- **æ•°æ®åº“**: SQLiteï¼ˆå¼€å‘ï¼‰/ PostgreSQLï¼ˆç”Ÿäº§æ¨èï¼‰
- **AI æ¨¡å‹**: ç™¾åº¦æ–‡å¿ƒå¤§æ¨¡å‹ï¼ˆERNiE-4.5-Turbo-VLï¼‰
- **API åº“**: OpenAI Python SDK
- **å›¾åƒå¤„ç†**: Pillow
- **å‰ç«¯**: Vanilla JavaScript + CSS3

## é…ç½®æ–‡ä»¶è¯´æ˜

### settings.py ä¸»è¦é…ç½®é¡¹

```text
# æ¦‚å¿µæ€§ settings å…³é”®é¡¹ï¼ˆç¤ºä¾‹ï¼Œä¸æ˜¯ç›´æ¥å¯å¤åˆ¶ä»£ç ï¼‰
# è¯´æ˜ï¼šä»¥ä¸‹å˜é‡å®é™…åº”åœ¨ settings.py ä¸­å®šä¹‰æˆ–å·²å­˜åœ¨ã€‚
# - DATA_UPLOAD_MAX_MEMORY_SIZE / FILE_UPLOAD_MAX_MEMORY_SIZE: ä¸Šä¼ å¤§å°é™åˆ¶ï¼ˆä¾‹å¦‚ 50MBï¼‰
# - OPENAI_API_KEY / OPENAI_BASE_URL: æ¥è‡ªç¯å¢ƒå˜é‡ (.env)
# - MEDIA_ROOT / MEDIA_URL: æŒ‡å‘ media/ ä¸ '/media/'
# - LANGUAGE_CODE / TIME_ZONE: 'zh-hans' / 'Asia/Shanghai'
```

## æ•…éšœæ’é™¤

### é—®é¢˜ 1: å¯¼å…¥ Pillow å¤±è´¥

```bash
pip install --upgrade Pillow
```

### é—®é¢˜ 2: OpenAI API é”™è¯¯

æ£€æŸ¥ï¼š
1. `OPENAI_API_KEY` æ˜¯å¦æ­£ç¡®
2. ç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸
3. API é…é¢æ˜¯å¦å……è¶³

### é—®é¢˜ 3: å›¾ç‰‡ä¸Šä¼ å¤±è´¥

- æ£€æŸ¥æ–‡ä»¶å¤§å°æ˜¯å¦è¶…è¿‡é™åˆ¶
- ç¡®è®¤æ–‡ä»¶æ ¼å¼ä¸º PNG æˆ– JPG
- æ£€æŸ¥ `media/` æ–‡ä»¶å¤¹æƒé™

## æ€§èƒ½ä¼˜åŒ–å»ºè®®

1. **ç”Ÿäº§éƒ¨ç½²**:
   - ä½¿ç”¨ PostgreSQL æ›¿ä»£ SQLite
   - é…ç½® Nginx åå‘ä»£ç†
   - ä½¿ç”¨ Gunicorn æˆ– uWSGI ä½œä¸ºåº”ç”¨æœåŠ¡å™¨
   - å¯ç”¨é™æ€æ–‡ä»¶ç¼“å­˜

2. **API ä¼˜åŒ–**:
   - æ·»åŠ è¯·æ±‚ç¼“å­˜
   - å®ç°å¼‚æ­¥ä»»åŠ¡é˜Ÿåˆ—ï¼ˆCeleryï¼‰
   - æ·»åŠ é€Ÿç‡é™åˆ¶

3. **å‰ç«¯ä¼˜åŒ–**:
   - å‹ç¼©å’Œæœ€å°åŒ– CSS/JS
   - ä½¿ç”¨ CDN åŠ é€Ÿ
   - å¯ç”¨ Gzip å‹ç¼©

## æ‰©å±•åŠŸèƒ½å»ºè®®

- ğŸ” ç”¨æˆ·è®¤è¯å’Œæƒé™ç®¡ç†
- ğŸ“§ åˆ†æç»“æœé‚®ä»¶é€šçŸ¥
- ğŸ·ï¸ æ ‡ç­¾å’Œåˆ†ç±»ç³»ç»Ÿ
- ğŸ”„ å¯¼å‡ºåŠŸèƒ½ï¼ˆPDF/Wordï¼‰
- ğŸ“± ç§»åŠ¨ç«¯é€‚é…ä¼˜åŒ–
- ğŸŒ å¤šè¯­è¨€æ”¯æŒ

## è®¸å¯è¯

MIT License

## è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·æäº¤ Issue æˆ– Pull Requestã€‚

---

**æœ€åæ›´æ–°**: 2025å¹´10æœˆ31æ—¥

## ğŸ§  å¤šå±‚æ¬¡æ£€ç´¢å¢å¼ºè¯†åˆ«æ¶æ„æ¦‚è¿°ï¼ˆRAG æ›´æ–°ï¼‰
æœ¬é¡¹ç›®ç°å·²å¼•å…¥â€œæ•°æ®ç”Ÿæˆ â†’ ç‰¹å¾å‘é‡åŒ–æ£€ç´¢ â†’ çŸ¥è¯†èåˆç”Ÿæˆ â†’ åº”ç”¨å±•ç¤ºâ€å››å±‚æ¶æ„ï¼š
1. æ•°æ®ç”Ÿæˆæ¨¡å—ï¼šç»Ÿä¸€å¤ç±å¤šæ¨¡æ€æ ·æœ¬ï¼ˆå›¾åƒ + OCR æ–‡æœ¬ + ä¸“å®¶æ ‡æ³¨ï¼‰ï¼Œè§„èŒƒåŒ–ä¸ç»“æ„åŒ–ï¼ˆè®¡åˆ’ï¼šJSON-LD æ ¼å¼ï¼‰ã€‚
2. æ£€ç´¢å™¨æ¨¡å—ï¼šä½¿ç”¨ CLIP æ¨¡å‹ï¼ˆ`rag/embeddings.py`ï¼‰å°†å›¾åƒ/æ–‡æœ¬è½¬ä¸º 512 ç»´å‘é‡ï¼Œå†™å…¥ Faiss ç¨ å¯†ç´¢å¼•ï¼Œå®ç°â€œä»¥å›¾æœå›¾ / ä»¥æ–‡æœå›¾ / ä»¥å›¾æ‰¾ç‰ˆæœ¬â€ã€‚
3. ç”Ÿæˆå™¨æ¨¡å—ï¼šé€šè¿‡ RAG æ¡†æ¶è°ƒç”¨ ERNIE-4.5-Turbo-VLï¼Œå°†æ£€ç´¢åˆ°çš„ç›¸ä¼¼æ ·æœ¬ä¸Šä¸‹æ–‡ï¼ˆretrieved_contextï¼‰ä¸å½“å‰å›¾ç‰‡è”åˆæ¨ç†ï¼›æ”¯æŒé«˜çº§ JSON ç»“æ„åŒ–è¾“å‡º Promptï¼ˆ`rag/prompt.py`ï¼‰ã€‚
4. åº”ç”¨å±‚ï¼šDjango æä¾›ä¸Šä¼ ã€è¯†åˆ«ã€å†å²è®°å½•ã€æœªæ¥ä¸“å®¶ååŒæ¥å£ã€‚

### æ–°å¢ç›®å½•
```
rag/
â”œâ”€â”€ embeddings.py      # CLIP å‘é‡ç”Ÿæˆï¼ˆå»¶è¿Ÿæˆ–ç«‹å³åŠ è½½ï¼‰
â”œâ”€â”€ retriever.py       # Faiss å‘é‡æ£€ç´¢å°è£…
â”œâ”€â”€ pipeline.py        # RAGPipeline å°†æ£€ç´¢ + Prompt + ç”Ÿæˆä¸²è”
â”œâ”€â”€ prompt.py          # é«˜çº§ JSON è¾“å‡º Prompt æ¨¡æ¿
```

### å¿«é€Ÿå‘é‡ç´¢å¼•æ„å»ºï¼ˆFaissï¼‰
```bash
# ç”Ÿæˆ/é‡å»ºå‘é‡ç´¢å¼•ï¼ˆéå† media/uploads ä¸‹å›¾ç‰‡ï¼‰
python scripts/build_index.py
# ç”Ÿæˆåå¾—åˆ°: rag/faiss.index
```

### ä½¿ç”¨ RAGPipeline ç¤ºä¾‹
```python
from rag.pipeline import RAGPipeline

pipeline = RAGPipeline(index_path="rag/faiss.index", db_path="db.sqlite3")
result_markdown_or_json = pipeline.run(
    image_path="media/uploads/2025/11/05/example.png",
    script_type="ç”²éª¨æ–‡",
    hint="å•†æ™šæœŸ åœè¾ æ®‹ç‰‡"
)
print(result_markdown_or_json)
```
> å½“å‰ `pipeline.run` è¿”å›ä¾èµ– `analyze_ancient_script` çš„é»˜è®¤ Markdownï¼›å¦‚éœ€å¼ºåˆ¶ JSON ç»“æ„åŒ–è¾“å‡ºï¼Œå¯æ”¹ä¸ºï¼š
```text
# å¼ºåˆ¶ JSON è¾“å‡ºæ­¥éª¤ï¼ˆç¤ºä¾‹æµç¨‹ï¼‰
1. è·å–æ£€ç´¢ä¸Šä¸‹æ–‡åˆ—è¡¨ retrieved_contextï¼ˆå¦‚ Top-5 ç›¸ä¼¼æ ·æœ¬æ ‡é¢˜ï¼‰ã€‚
2. è°ƒç”¨ get_prompt(script_type, hint, retrieved_context)ã€‚
3. è°ƒç”¨ analyze_ancient_script(image, script_type, hint, prompt=ç”Ÿæˆçš„prompt)ã€‚
4. å¾—åˆ°çš„ result å³ä¸ºæ¨¡å‹è¿”å›çš„ JSON å­—ç¬¦ä¸²ï¼ˆéœ€å‰ç«¯è§£æï¼‰ã€‚
# å¤‡æ³¨ï¼šç¤ºä¾‹ä¸­ image ä¸ºå·²åŠ è½½çš„ PIL.Image å¯¹è±¡ï¼›æ‰€æœ‰æ­¥éª¤éœ€åœ¨ Django è¿è¡Œç¯å¢ƒä¸­ã€‚
```

### é«˜çº§ JSON Prompt ç»“æ„è¯´æ˜ï¼ˆä¸é»˜è®¤ Markdown çš„åŒºåˆ«ï¼‰
- é»˜è®¤ï¼š`app/analysis.py` åœ¨æœªä¼  `prompt` æ—¶ç”Ÿæˆåˆ†èŠ‚ Markdownã€‚
- é«˜çº§ï¼š`rag/prompt.py` æä¾›ä¸¥æ ¼ JSON æ¨¡æ¿ï¼ˆå­—æ®µï¼špreliminary_readingã€glyph_keypoints_and_evidenceã€tentative_transcription ç­‰ï¼‰ã€‚
- é›†æˆç­–ç•¥ï¼š
  1. æ„å»ºå‘é‡ç´¢å¼• â†’ æ£€ç´¢ Top-K â†’ å½¢æˆ `retrieved_context` åˆ—è¡¨ã€‚
  2. ä½¿ç”¨ `get_prompt()` ç”Ÿæˆå¸¦ä¸Šä¸‹æ–‡çš„ JSON ç»“æ„ Promptã€‚
  3. è°ƒç”¨ `analyze_ancient_script(..., prompt=prompt)` è·å– JSON å­—ç¬¦ä¸²ã€‚
  4. å‰ç«¯è§£æå¹¶å±•ç¤ºï¼ˆéœ€åœ¨åç»­ç‰ˆæœ¬æ–°å¢ JSON æ¸²æŸ“é€»è¾‘ï¼‰ã€‚

### è¿ç§»æ–‡ä»¶ï¼ˆ`app/migrations/`ï¼‰å¤„ç†å»ºè®®
| åœºæ™¯ | æ˜¯å¦å¯åˆ é™¤è¿ç§» | æ“ä½œå»ºè®® |
|------|----------------|----------|
| ä¸ªäººæœ¬åœ°è¯•éªŒï¼ˆå¯ä¸¢å¼ƒæ•°æ®ï¼‰ | âœ… å¯ | åˆ é™¤é™¤ `__init__.py` å¤–æ–‡ä»¶ â†’ åˆ é™¤ `db.sqlite3` â†’ é‡æ–° `makemigrations && migrate` |
| å·²æ¨é€åˆ°è¿œç¨‹ä»“åº“ / å›¢é˜Ÿåä½œ | âŒ ä¸å»ºè®® | ä¿ç•™å†å²æ¼”è¿›ï¼Œé¿å…åŒäº‹æ•°æ®åº“çŠ¶æ€ä¸ä¸€è‡´ |
| å‡†å¤‡é‡å¤§æ¨¡å‹é‡æ„ä¸”å°šæœªä¸Šçº¿ç”Ÿäº§ | âš  è¯„ä¼°å | åœ¨åˆ†æ”¯ä¸Šæ¸…ç†å¹¶ç”Ÿæˆâ€œsquashâ€è¿ç§»ï¼Œåˆå¹¶æ—¶å…¬å‘Š |
| å·²ä¸Šçº¿ç”Ÿäº§ | âŒ ç¦æ­¢ | ä½¿ç”¨æ–°è¿ç§»å¢é‡æ¼”è¿›ï¼›å¦‚éœ€é‡æ„ç”¨æ•°æ®è¿ç§»è„šæœ¬ï¼ˆRunPythonï¼‰ |

å¿«é€Ÿé‡ç½®ç¤ºä¾‹ï¼ˆä»…å¼€å‘ç¯å¢ƒï¼‰ï¼š
```bash
rm app/migrations/00*.py db.sqlite3
python manage.py makemigrations
python manage.py migrate
```

### æ€§èƒ½ä¸èµ„æºæç¤º
- é¦–æ¬¡åŠ è½½ CLIP æ¨¡å‹ä¼šä¸‹è½½å‚æ•°ï¼ˆå»ºè®®åœ¨éƒ¨ç½²é•œåƒé˜¶æ®µé¢„ä¸‹è½½ï¼‰ã€‚
- Faiss æ£€ç´¢ä¸ºå†…å­˜å‹ï¼›å¤§è§„æ¨¡æ•°æ®è¯·è€ƒè™‘ IVF/Flat+PQã€åˆ†ç‰‡æˆ– Milvus/Weaviate ç­‰å‘é‡åº“ã€‚
- è‹¥ GPU ä¸å¯ç”¨ï¼Œ`torch` ä¼šè‡ªåŠ¨å›é€€ CPUï¼ˆé€Ÿåº¦é™ä½ï¼‰ã€‚
- ç»“æ„åŒ– JSON è¾“å‡ºå¯¹ä¸Šä¸‹æ–‡é•¿åº¦æ•æ„Ÿï¼Œå»ºè®®é™åˆ¶æ£€ç´¢æ¡ç›®ï¼ˆå¦‚ Top-5ï¼‰ã€‚

### åç»­è§„åˆ’ï¼ˆRoadmap æ‘˜è¦ï¼‰
- [ ] å°†æ ·æœ¬æ ‡æ³¨æ ¼å¼å‡çº§ä¸º JSON-LDï¼ˆå«æ–­è£‚ç­‰çº§ / ä¿®å¤å»ºè®® / ç‰ˆæœ¬æŒ‡çº¹ï¼‰ã€‚
- [ ] å‘é‡ç´¢å¼•æ”¯æŒå¢é‡æ›´æ–°ï¼ˆæ–°å¢å›¾ç‰‡è‡ªåŠ¨è¿½åŠ ï¼‰ã€‚
- [ ] å°† RAGPipeline çš„æ£€ç´¢ä¸Šä¸‹æ–‡æŒä¹…åŒ–ä¸ç¼“å­˜ã€‚
- [ ] å‰ç«¯æ”¯æŒ JSON ç»“æ„åŒ–ç»“æœçš„å¯è§†åŒ–æ ‡ç­¾ï¼ˆå€™é€‰å­—é«˜äº®ï¼‰ã€‚
- [ ] é›†æˆåˆ†å¸ƒå¼ä»»åŠ¡é˜Ÿåˆ—ï¼ˆCeleryï¼‰å¤„ç†æ‰¹é‡æ„å»ºç´¢å¼•ã€‚

## ğŸ”Œ æ–°å¢ä¾èµ–è¯´æ˜
å½“å‰ `requirements.txt` å·²åŒ…å«ï¼š`faiss-cpu`, `torch`, `transformers`, `sentencepiece`ï¼›å¦‚é‡ macOS ARM æ¶æ„å®‰è£…é—®é¢˜ï¼Œå¯å°è¯•ï¼š
```bash
pip install --extra-index-url https://download.pytorch.org/whl/cpu torch --no-cache-dir
```
æˆ–ä½¿ç”¨ Conda å®‰è£…ï¼š
```bash
conda install -c pytorch pytorch
conda install -c conda-forge faiss-cpu
```

## ğŸ§ª ç®€æ˜“éªŒè¯è„šæœ¬ï¼ˆå‘é‡ + æ£€ç´¢ï¼‰
```python
from rag.embeddings import get_text_embedding
from rag.retriever import FaissRetriever

# å‡è®¾å·²æ„å»º rag/faiss.index
vec = get_text_embedding("ç”²éª¨æ–‡ åœè¾ ç‹åœ")
retriever = FaissRetriever("rag/faiss.index")
print(retriever.search(vec, k=3))
```

## ğŸ“Œ æ–‡æ¡£æ›´æ–°è®°å½•
- 2025-11-07: å¢è¡¥ RAG å¤šå±‚æ¶æ„ã€Faiss æ„å»ºä¸ä½¿ç”¨ã€JSON Promptã€è¿ç§»æ–‡ä»¶ç­–ç•¥ã€æ€§èƒ½ä¸ Roadmapã€‚
